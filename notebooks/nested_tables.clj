(ns notebooks.nested-tables
  {:nextjournal.clerk/visibility {:code :hide}
   :nextjournal.clerk/no-cache true}
  (:require [nextjournal.clerk :as clerk]
            [nextjournal.clerk.viewer :as viewer]))

(def nested-table
  [{:parking-spot "BS2/1/7",
    :compound/name "Krefeld",
    :customer/name "BMW AG",
    :ductile/id #uuid "30b6dfd7-be30-4d68-bdea-8992b35810e7",
    :entry/datetime #inst "2023-11-20T11:50:15.611Z",
    :entry/transport-order {:ductile/id #uuid "0a232ee8-5b0d-4f3d-b1b3-0f3699064e74",
                            :edi/instruction-ids ["56" "57"],
                            :external.bmw/carrier-code "0068207710",
                            :external.bmw/spediteur "0000021",
                            #_#_:transport/load-number "986191523802911425-9",
                            :transport/mode :mode/train},
    :exit/transport-order {:ductile/id #uuid "47263088-613e-40c7-ba8e-d336fe14ae86",
                           :edi/instruction-ids ["58" "59"],
                           :external.bmw/carrier-code "0068207710",
                           :external.bmw/spediteur "0001000",
                           :transport/mode :mode/truck},
    :external.bmw/color-code "0475",
    :external.bmw/model-code "81CY",
    :fahrzeug/expected-customer-delivery-datetime #inst "2023-11-29T23:00:00Z",
    :make/name "BMW",
    :parking-spot/place 7,
    :parking-spot/row 1,
    :parking-spot/status :parking-spot.status/occupied,
    :parking-zone/name "BS2",
    :vehicle/dimensions "4713×1827×1442",
    :vehicle/height-mm 1442,
    :vehicle/length-mm 4713,
    :vehicle/vin "WBA81CY0X0FR62676",
    :vehicle/weight 1900,
    :vehicle/width-mm 1827}
   {:parking-spot "A/9/1",
    :compound/name "Krefeld",
    :customer/name "BMW AG",
    :ductile/id #uuid "8ff1e5a6-824e-4929-9128-5279b0a4dd9b",
    :entry/datetime #inst "2023-11-20T11:50:16.842Z",
    :entry/transport-order {:ductile/id #uuid "e6928cee-0888-4029-bcca-6d5fcbafa978",
                            :edi/instruction-ids ["60" "61"],
                            :external.bmw/carrier-code "0068207710",
                            :external.bmw/spediteur "0000021",
                            :transport/load-number "986191523802911425-9",
                            :transport/mode :mode/train},
    :exit/transport-order {:ductile/id #uuid "d87c671e-c104-49cb-b476-45a86f15fb88",
                           :edi/instruction-ids ["62" "63"],
                           :external.bmw/carrier-code "0068207710",
                           :external.bmw/spediteur "0001000",
                           :transport/mode :mode/truck},
    :external.bmw/color-code "0475",
    :external.bmw/model-code "31FZ",
    :fahrzeug/expected-customer-delivery-datetime #inst "2023-11-29T23:00:00Z",
    :make/name "BMW",
    :parking-spot/place 1,
    :parking-spot/row 9,
    :parking-spot/status :parking-spot.status/occupied,
    :parking-zone/name "A",
    :vehicle/dimensions "4713×1827×1445",
    :vehicle/height-mm 1445,
    :vehicle/length-mm 4713,
    :vehicle/vin "WBA31FZ010FR63760",
    :vehicle/weight 1800,
    :vehicle/width-mm 1827}
   {:parking-spot "BS2/1/11",
    :compound/name "Krefeld",
    :customer/name "BMW AG",
    :ductile/id #uuid "9051594b-ff49-4264-91ba-b1b911df850c",
    :entry/datetime #inst "2023-11-20T11:50:16.618Z",
    :entry/transport-order {:ductile/id #uuid "d67c4268-ab07-4bcd-994c-9888e5b2dac0",
                            :edi/instruction-ids ["112" "113"],
                            :external.bmw/carrier-code "0068207710",
                            :external.bmw/spediteur "0001000",
                            :origin/location {:compound/name "Krefeld"},
                            :transport/mode :mode/truck},
    :external.bmw/color-code "0C2M",
    :external.bmw/model-code "21DL",
    :fahrzeug/expected-customer-delivery-datetime #inst "2023-11-29T23:00:00Z",
    :make/name "Mini",
    :parking-spot/place 11,
    :parking-spot/row 1,
    :parking-spot/status :parking-spot.status/occupied,
    :parking-zone/name "BS2",
    :vehicle/dimensions "3863×1727×1415",
    :vehicle/height-mm 1415,
    :vehicle/length-mm 3863,
    :vehicle/vin "WMW21DL0203R84479",
    :vehicle/weight 1360,
    :vehicle/width-mm 1727}
   {:parking-spot "A/8/1",
    :compound/name "Krefeld",
    :customer/name "BMW AG",
    :ductile/id #uuid "7b53e6e2-6a27-4fda-a74e-64f9d4c0d36b",
    :entry/datetime #inst "2023-11-20T11:50:15.800Z",
    :entry/transport-order {:ductile/id #uuid "5e523d97-7af5-41f7-ba05-da69bfdfd94f",
                            :edi/instruction-ids ["128" "129"],
                            :external.bmw/carrier-code "0068207710",
                            :external.bmw/spediteur "0001000",
                            :origin/location {:compound/name "Krefeld"},
                            :transport/mode :mode/truck},
    :external.bmw/color-code "0C4R",
    :external.bmw/model-code "21DL",
    :fahrzeug/expected-customer-delivery-datetime #inst "2023-11-29T23:00:00Z",
    :make/name "Mini",
    :parking-spot/place 1,
    :parking-spot/row 8,
    :parking-spot/status :parking-spot.status/occupied,
    :parking-zone/name "A",
    :vehicle/dimensions "3863×1727×1415",
    :vehicle/height-mm 1415,
    :vehicle/length-mm 3863,
    :vehicle/vin "WMW21DL0903R85970",
    :vehicle/weight 1360,
    :vehicle/width-mm 1727}
   {:parking-spot "BS2/1/10",
    :compound/name "Krefeld",
    :customer/name "BMW AG",
    :ductile/id #uuid "96402b65-a289-460d-b6c5-ad1cfbf9bee3",
    :entry/datetime #inst "2023-11-20T11:50:16.405Z",
    :entry/transport-order {:ductile/id #uuid "9c9895a4-ae6b-49fb-aaee-6d5a8bee2896",
                            :edi/instruction-ids ["140" "141"],
                            :external.bmw/carrier-code "0068207710",
                            :external.bmw/spediteur "0001000",
                            :origin/location {:compound/name "Krefeld"},
                            :transport/load-number "LKW",
                            :transport/mode :mode/truck},
    :exit/transport-order {:ductile/id #uuid "88fe51ea-d887-44c1-925f-7ada0d1cf3aa",
                           :edi/instruction-ids ["142"
                                                 "143"
                                                 "188"
                                                 "189"],
                           :external.bmw/carrier-code "0068207710",
                           :external.bmw/spediteur "0001000",
                           :transport/mode :mode/truck},
    :external.bmw/color-code "0C37",
    :external.bmw/model-code "HF51",
    :fahrzeug/expected-customer-delivery-datetime #inst "2023-11-29T23:00:00Z",
    :make/name "BMW",
    :parking-spot/place 10,
    :parking-spot/row 1,
    :parking-spot/status :parking-spot.status/occupied,
    :parking-zone/name "BS2",
    :vehicle/dimensions "4324×1864×1304",
    :vehicle/height-mm 1304,
    :vehicle/length-mm 4324,
    :vehicle/vin "WBAHF51090WY31679",
    :vehicle/weight 1640,
    :vehicle/width-mm 1864}
   {:parking-spot "BS2/1/9",
    :compound/name "Krefeld",
    :customer/name "BMW AG",
    :ductile/id #uuid "af53df4f-1817-456c-88ed-9de95adf3541",
    :entry/datetime #inst "2023-11-20T11:50:16.210Z",
    :entry/transport-order {:ductile/id #uuid "474a4e3b-9b74-4743-b214-16791fe8b522",
                            :edi/instruction-ids ["154" "155"],
                            :external.bmw/carrier-code "0031060510",
                            :external.bmw/spediteur "0007058",
                            :transport/load-number "9854631MGT430/BM294",
                            :transport/mode :mode/truck},
    :exit/transport-order {:ductile/id #uuid "5187f960-3e8f-4459-b3c2-ea2138f4ef36",
                           :edi/instruction-ids ["156" "157"],
                           :external.bmw/carrier-code "0068207710",
                           :external.bmw/spediteur "0001000",
                           :transport/mode :mode/truck},
    :external.bmw/color-code "0C4P",
    :external.bmw/model-code "11DT",
    :fahrzeug/expected-customer-delivery-datetime #inst "2023-11-29T23:00:00Z",
    :make/name "BMW",
    :parking-spot/place 9,
    :parking-spot/row 1,
    :parking-spot/status :parking-spot.status/occupied,
    :parking-zone/name "BS2",
    :vehicle/dimensions "4751×1918×1621",
    :vehicle/height-mm 1621,
    :vehicle/length-mm 4751,
    :vehicle/vin "WBA11DT0409S54937",
    :vehicle/weight 1875,
    :vehicle/width-mm 1918}
   {:parking-spot "BS2/1/8",
    :compound/name "Krefeld",
    :customer/name "BMW AG",
    :ductile/id #uuid "d9c46f04-b800-40e2-ba10-cb581e853ee2",
    :entry/datetime #inst "2023-11-20T11:50:15.995Z",
    :entry/transport-order {:ductile/id #uuid "bc39e9df-d539-4c72-bced-53faf06b9ae7",
                            :edi/instruction-ids ["178" "179"],
                            :external.bmw/carrier-code "0068207710",
                            :external.bmw/spediteur "0001000",
                            :origin/location {:compound/name "Krefeld"},
                            :transport/load-number "LKW",
                            :transport/mode :mode/truck},
    :exit/transport-order {:ductile/id #uuid "d607c739-d479-4f3c-9c8a-a0cc60250b1e",
                           :edi/instruction-ids ["180"
                                                 "181"
                                                 "182"
                                                 "183"],
                           :external.bmw/carrier-code "0068207710",
                           :external.bmw/spediteur "0001000",
                           :transport/mode :mode/truck},
    :external.bmw/color-code "0475",
    :external.bmw/model-code "HF51",
    :fahrzeug/expected-customer-delivery-datetime #inst "2023-11-29T23:00:00Z",
    :make/name "BMW",
    :parking-spot/place 8,
    :parking-spot/row 1,
    :parking-spot/status :parking-spot.status/occupied,
    :parking-zone/name "BS2",
    :vehicle/dimensions "4324×1864×1304",
    :vehicle/height-mm 1304,
    :vehicle/length-mm 4324,
    :vehicle/vin "WBAHF51090WY31598",
    :vehicle/weight 1640,
    :vehicle/width-mm 1864}
   {:parking-spot "BS2/1/12",
    :compound/name "Krefeld",
    :customer/name "BMW AG",
    :ductile/id #uuid "9f8c9c9a-2fcf-42fb-8148-2d2c6b9e9f84",
    :entry/datetime #inst "2023-11-20T11:50:17.032Z",
    :entry/transport-order {:ductile/id #uuid "d7b31f27-a850-4bb6-88df-0112e743143d",
                            :edi/instruction-ids ["190" "191"],
                            :external.bmw/carrier-code "0031060510",
                            :external.bmw/spediteur "0007058",
                            :transport/load-number "9854631MGT430/BM294",
                            :transport/mode :mode/truck},
    :exit/transport-order {:ductile/id #uuid "b21308f9-aca1-4814-8c2e-71296f4cff47",
                           :edi/instruction-ids ["192" "193"],
                           :external.bmw/carrier-code "0068207710",
                           :external.bmw/spediteur "0001000",
                           :transport/mode :mode/truck},
    :external.bmw/color-code "0C4P",
    :external.bmw/model-code "11AV",
    :fahrzeug/expected-customer-delivery-datetime #inst "2023-11-29T23:00:00Z",
    :make/name "BMW",
    :parking-spot/place 12,
    :parking-spot/row 1,
    :parking-spot/status :parking-spot.status/occupied,
    :parking-zone/name "BS2",
    :vehicle/dimensions "4783×1852×1442",
    :vehicle/height-mm 1442,
    :vehicle/length-mm 4783,
    :vehicle/vin "WBA11AV050FR60702",
    :vehicle/weight 1695,
    :vehicle/width-mm 1852}])

#_(viewer/normalize-table-data nested-table)

#_(viewer/process-sub-tables (viewer/normalize-table-data nested-table))

^{::clerk/width :full}
(clerk/table nested-table)
